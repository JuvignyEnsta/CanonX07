10 REM SAMARCANDE (Jeux et strategie num. 37)
12 CONSOLE 0, 4, 0, 1, 0
15 GOSUB 1900 : GOTO 1960
20 AR = 200 : REM ARGENT
30 T$(1) = CHR$(134)+CHR$(135)
40 T$(2) = CHR$(138)+CHR$(139)
50 DATA DES FUSILS, 30
60 DATA UNE BOUSSOLE, 30
70 DATA DU SEL, 5
80 DATA DES PEAUX, 25
90 DATA DES CARTES, 15
100 RESTORE 50 : FOR I=1 TO 5
110 READ OB$(I), PX(I) : NEXT I
120 G = 123
130 PV = 100
140 XD = 80 : YD = 80
150 REM ---( LOCALISATION )---
160 T = RND(0)
170 XS = INT(RND(1)*100)+1
180 T = RND(0)
190 YS = INT(RND(1)*100)+1
200 REM ---( POPULATION )---
210 A$(1) = CHR$(134)+CHR$(135) : A$(2) = CHR$(136)+CHR$(137)
220 A$(3) = CHR$(138)+CHR$(139)
225 A(1) = 0 : A(2) = 0 : A(3) = 0
230 FOR I = 1 TO 3
240 T = RND(0)
250 X = INT(RND(1)*3)+1
260 IF A(X)=1 THEN GOTO 240
270 N$(I) = A$(X) : A(X) = 1
280 NEXT I
290 GOTO 350
300 REM ---( INVENTAIRE )---
310 CLS : FOR I = 1 TO 3
315 IF (OB(I)=1) THEN PRINT "-"; OB$(I) : BEEP 12, 2
320 NEXT I : PRINT "N pour suite...";
322 C$ = INKEY$ : IF C$<>"N" THEN GOTO 322
325 CLS : FOR I = 4 TO 6
326 IF (OB(I)=1) THEN PRINT "-"; OB$(I) : BEEP 12, 2
327 NEXT I : PRINT "N pour suite";
328 C$ = INKEY$ : IF C$<>"N" THEN GOTO 328
329 CLS : FOR I = 7 TO 9
330 IF (OB(I)=1) THEN PRINT "-"; OB$(I) : BEEP 12, 2
335 NEXT I : PRINT "Q pour quitter";
338 C$ = INKEY$ : IF C$<>"Q" THEN GOTO 338
340 RETURN
350 REM --( Deplacement --)
351 CLS : PRINT "P.V"; PV
352 IF OB(2)=1 THEN PRINT "LOC. ";XD;", ";YD
353 PRINT "Argent "; AR
360 PRINT "DIRECTION ?";
370 C$ = INKEY$
380 IF C$="" THEN GOTO 370
390 IF C$="I" THEN GOSUB 300 : GOTO 351
400 PV = PV - 1
410 IF PV <= 0 THEN GOTO 1986
420 IF PV > 100 THEN PV = 100
430 IF C$="N" THEN YD = YD + 1 : GOTO 480
440 IF C$="S" THEN YD = YD - 1 : GOTO 480
450 IF C$="E" THEN XD = XD + 1 : GOTO 480
460 IF C$="O" THEN XD = XD - 1 : GOTO 480
470 GOTO 351
480 Z = ABS(COS(XD*G)*SIN(YD*G)*100)
530 NC = INT(Z)
540 REM ---( APPEL GRAPHISME )---
550 GOSUB 580
560 GOTO 930
580 REM --( RENDU GRAPHIQUE )--
590 CLS : A = Z : A = A - INT(A)
600 B = INT(A*100)
610 C = INT((A*100-B)*100)
620 Y = 16
630 LINE (0,0) - (119,0) : LINE (119,0) - (119,31)
640 LINE (119,31) - (0,31) : LINE (0,31) - (0,0)
680 REM -- Dessin relief --
690 D = 0 : XO = 0 : FOR X = 4 TO 120 STEP 4
695 YO = Y
700 D = D + B + C + 20
710 IF D > 100 THEN D = D - 100 : GOTO 710
720 IF D>0 AND D<10 THEN Y = Y + 5
730 IF D>9 AND D<20 THEN Y = Y - 5
740 IF D>19 AND D<30 THEN Y=Y+4
750 IF D>29 AND D<40 THEN Y=Y-4
760 IF D>39 AND D<50 THEN Y=Y+3
770 IF D>49 AND D<60 THEN Y=Y-3
780 IF D>59 AND D<70 THEN Y=Y+2
790 IF D>69 AND D<80 THEN Y=Y-2
800 IF D>79 AND D<90 THEN Y=Y+1
810 IF D>89 AND D<100 THEN Y=Y-1
815 IF Y>24  THEN Y = 24
816 IF Y<0   THEN Y = 0
820 LINE (XO,YO) - (X-1,Y)
830 XO = X : NEXT X
840 REM --( 2. DESSIN SABLE --)
850 FOR G = 31 TO 24 STEP -1
860 X = INT(RND(1)*117)
870 LINE (X,G) - (X+2,G)
880 NEXT G
890 IF XS = XD  AND YS = YD THEN GOTO 1730
900 REM --( 3. Dessin vegetation )--
905 LINE (0,24) - (119,24)
910 LINE (B,3) - (B,26)
920 RETURN
930 REM --( Gestion des evenements --)
950 IF XS=XD AND YS=YD THEN GOTO 1730
960 IF NC>10 AND NC<34 THEN GOTO 1010
970 IF NC>33 AND NC<40 THEN GOTO 1550
980 IF NC>39 AND NC<50 THEN GOTO 1590
990 IF NC>49 AND NC<54 THEN GOTO 1690
995 K = STRIG(0) : IF K = 0 THEN GOTO 995
1000 GOTO 351
1010 REM --( Rencontre --)
1020 T = INT(RND(1)*3+1)
1030 K = RAND(0)
1040 R = INT(RND(1)*100)+1
1050 IF R>50 THEN GOTO 1090
1060 LOCATE 9,3 : PRINT CHR$(132);CHR$(133);
1080 GOTO 995
1090 LOCATE 9,2 : PRINT N$(T)
1100 LOCATE 9,3 : PRINT CHR$(140);CHR$(141);
1110 LOCATE 0,0 : PRINT "T(roc) ou (I)nfo";
1120 R$ = INKEY$ : IF R$="" THEN 1120
1130 IF R$="T" THEN GOTO 1390
1140 IF R$="I" THEN GOTO 1170
1150 CLS : PRINT "Au revoir, bonne route !";
1160 K = STRIG(0) : IF K = 0 THEN GOTO 1160
1165 GOTO 351
1170 REM --( Renseignement )--
1180 LX = XD - XS : LY = YD - YS
1190 IF LX > 0 AND LX > ABS(LY) THEN D=4 : GOTO 1280
1200 IF LX < 0 AND -LX > ABS(LY) THEN D=2 : GOTO 1280
1210 IF LY > 0 AND LY > ABS(LX) THEN D=3 : GOTO 1280
1220 IF LY < 0 AND -LY > ABS(LX) THEN D=1 : GOTO 1280
1230 CLS : PRINT "- Je ne sais pas" : GOTO 1380
1280 IF T=1 THEN GOTO 1330
1290 IF T=3 THEN D=INT(RND(1)*4)+1 : GOTO 1330
1300 IF T=2 THEN D = D + 2
1310 IF D > 4 THEN D = D - 4
1330 IF D=1 THEN DR$="au Nord"
1340 IF D=2 THEN DR$="a l'Est"
1350 IF D=3 THEN DR$="au Sud"
1360 IF D=4 THEN DR$="a l'Ouest"
1370 CLS : PRINT "Samarcande est "; DR$
1380 K = STRIG(0) : IF K = 0 THEN GOTO 1380
1385 GOTO 351
1389 REM --( Troc )--
1390 CLS : K = RND(0)
1400 VA = INT(RND(1)*2)+1
1410 I  = INT(RND(1)*5)+1
1420 Z  = INT(RND(1)*20)+10
1430 PR = INT(PX(I)+Z) : M% = 0 : LOCATE 0,0
1440 IF VA=1 THEN M% = 1 : PRINT "Je vends ";
1450 IF VA=2 THEN M% =-1 : PRINT "J achete ";
1460 PRINT OB$(I);  " a "; PR; " direms (O/N)";
1470 R$ = INKEY$ : IF R$="" THEN 1470
1480 IF M%=1 AND AR<PR THEN PRINT "DESOLE !" : GOTO 1380
1490 IF M%=-1 AND OB(I)=0 THEN PRINT "Ah, aucun ? Salut !" : GOTO 1380
1500 IF R$ <> "O" THEN PRINT "Dommage ! Salut." : GOTO 1380
1510 IF M%=1 THEN OB(I) = 1
1520 IF M%=-1 THEN OB(I) = 0
1530 AR = AR + (PR*(-M%))
1540 PRINT "Merci. Salut !" : GOTO 1380
1550 REM --( Evenements )--
1560 LOCATE 9,2 : PRINT CHR$(128);CHR$(129);
1570 LOCATE 9,3 : PRINT CHR$(130);CHR$(131);
1580 PV = PV + 10 : GOTO 1380
1590 T = INT(RND(1)*2)+1
1600 LOCATE 9,2 : PRINT T$(T)
1610 LOCATE 9,3 : PRINT CHR$(142);CHR$(143);
1620 LOCATE 0,0 : PRINT "Fusils ? ";
1630 PF=INT(RND(1)*70)+(15*T)
1640 PRINT PF; " direms ";
1650 R$ = INKEY$ : IF R$="" THEN 1650
1660 IF OB(1) = 0 THEN PRINT "Tant pis !" : GOTO 1380
1670 IF OB(1)=1 AND R$="O" THEN AR=AR+PF : OB(1)=0 : GOTO 1380
1680 PRINT "Dommage" : GOTO 1380
1690 LOCATE 9,2 : PRINT CHR$(136);CHR$(137);
1700 LOCATE 9,3 : PRINT CHR$(142);CHR$(143); : LOCATE 0,0
1710 IF OB(1)=1 THEN PRINT "Armes confisquees !"; : OB(1)=0 : GOTO 1380
1720 PRINT "Pas d'armes ? Circulez !" : GOTO 1380
1730 CLS : PRINT A$(2);        " < SAMARCANTE > "; A$(2)
1740 PRINT CHR$(142);CHR$(143);
1750 IF AR >= 200 THEN GOTO 1850
1760 PRINT "Pas d'argent ! "; CHR$(142);CHR$(143); 
1770 PRINT "   PARTEZ    ! " 
1780 K$ = INKEY$ : IF K$ = "" THEN 1780
1785 GOTO 351
1850 PRINT "   ENTREZ !    ";CHR$(142);CHR$(143)
1860 PRINT "Bravo ! Suite dans Nordal"
1865 FOR I = 1 TO 24 : BEEP I, 1 : NEXT I
1870 END
1900 REM --( Quelques graphismes )---
1905 REM << Puit >> : 128 + 129 // 130 + 131
1910 FONT$(128) = "0, 28, 252, 156, 132, 152, 248, 248"
1911 FONT$(129) = "0, 192, 252, 196, 4, 228, 252, 252"
1915 FONT$(130) = "252, 252, 152, 228, 152, 100, 28, 252"
1916 FONT$(131) = "252,252, 100, 156, 100, 152, 224, 252"
1919 REM << Pas dans le sable >>: 132 + 133
1920 FONT$(132) = "252, 0, 4, 12, 0, 48, 96, 252"
1921 FONT$(133) = "252, 12, 152, 0, 96, 192, 0, 252"
1924 REM << Capuche >> 134 + 135
1925 FONT$(134) = "12, 48, 64, 128, 156, 188, 164, 188"
1926 FONT$(135) = "192, 224, 24, 12, 228, 244, 52, 244"
1929 REM << Casque >> 136 + 137
1930 FONT$(136) = "12, 48, 68, 148, 128, 252, 164, 188"
1931 FONT$(137) = "192, 48, 136, 164, 4, 252, 52, 244"
1934 REM << Chapeau >> 138 + 139
1935 FONT$(138) = "12, 48, 68, 140, 192, 188, 164, 188"
1936 FONT$(139) = "192, 48, 8, 132, 12, 252, 60, 244"
1939 REM << Visage tribut >> 140 + 141
1940 FONT$(140) = "184, 156, 152, 140, 196, 160, 208, 232"
1941 FONT$(141) = "244, 244, 116, 244, 228, 12, 84, 176"
1944 REM << Visage marchand ou police >> 142 + 143
1945 FONT$(142) = "184, 132, 160, 164, 220, 168, 212, 232"
1946 FONT$(143) = "244, 132, 28, 156, 244, 172, 84, 176"
1950 RETURN
1955 REM --( Titre du jeu )--
1960 CLS : PRINT " ";CHR$(134);CHR$(135);" SAMARCANTE ";CHR$(136);CHR$(137)
1965 PRINT " "; CHR$(140);CHR$(141);      "    2025    ";CHR$(142);CHR$(143)
1966 PRINT "Jeux et Strategie 86";
1972 LOCATE 0, 3 : PRINT "Espace -> commencer";
1975 K = STRIG(0) : IF K=0 THEN GOTO 1975
1980 GOTO 20
1985 REM --( MORT )--
1986 CLS : PRINT "Vous etes mort"
1988 RESTORE 1995 : FOR I = 1 TO 11
1990 READ Du, Ha : BEEP Ha, Du : NEXT I
1991 LOCATE 0, 3 : PRINT "Espace pour cont.";
1992 K = STRIG(0) : IF K = 0 THEN GOTO 1992
1993 GOTO 1960
1995 DATA 4, 3, 3, 3, 1, 3, 4, 3, 3, 6, 1, 5, 3, 5, 1, 3, 3, 3, 1, 2, 4, 3