10 REM NORDAL LE MAGICIEN : Jeux et Strategie numero 38
20 CONSOLE 0, 4, 0, 1, 0
30 REM --- ( Definition des graphiques ) ---
40 REM HAUT DES GARDES : CHR$(128) + CHR$(129)
50 FONT$(128) = "4,12,60,216,176,252,252,100"
55 FONT$(129) = "128,192,240,108,196,252,244,152"
60 REM BAS DES GARDES : CHR$(130) + CHR$(131)
70 FONT$(130) = "124,88,72,128,108,96,240,40"
75 FONT$(131) = "244,184,212,88,148,56,116,248"
80 GA$(1) = CHR$(128) + CHR$(129) : GA$(2) = CHR$(130) + CHR$(131)
90 REM HAUT MENDIANTS : CHR$(132) + CHR$(133)
100 FONT$(132) = "12,48,64,128,148,156,164,188"
105 FONT$(133) = "192,240,88,172,92,236,60,236"
110 REM BAS MENDIANTS : CHR$(134) + CHR$(135)
120 FONT$(134) = "180,180,188,188,176,156,84,168"
125 FONT$(135) = "220,236,220,236,92,172,92,252"
130 ME$(1) = CHR$(132) + CHR$(133) : ME$(2) = CHR$(134) + CHR$(135)
140 REM HAUT MARCHAND : CHR$(136) + CHR$(137)
150 FONT$(136) = "28,32,124,252,252,212,128,220"
155 FONT$(137) = "224,16,248,252,252,84,12,116"
160 REM BAS MARCHAND : CHR$(138) + CHR$(139)
170 FONT$(138) = "136,204,128,200,220,228,232,244"
175 FONT$(139) = "36,52,68,212,244,204,188,124"
180 MR$(1) = CHR$(136) + CHR$(137) : MR$(2) = CHR$(138) + CHR$(139)
190 REM HAUT MAGICIEN : CHR$(140) + CHR$(141)
200 FONT$(140) = "0,4,12,24,52,104,252,252"
205 FONT$(141) = "248,188,116,160,96,184,248,252"
210 REM BAS MAGICIEN : CHR$(142) + CHR$(143)
220 FONT$(142) = "220,204,64,64,36,32,228,80"
225 FONT$(143) = "252,108,140,136,16,16,156,40"
230 MG$(1) = CHR$(140) + CHR$(141) : MG$(2) = CHR$(142) + CHR$(143)
240 REM --- ( Ecran titre ) ---
250 CLS : PRINT GA$(1); "JEUX & STRATEGIE";ME$(1);
260 PRINT GA$(2); "    presente    ";ME$(2);
270 PRINT " ";MR$(1); "  NORDAL  LE  ";MG$(1)
280 PRINT " ";MR$(2); "   MAGICIEN   ";MG$(2);
285 FOR I%=24 TO 1 STEP -1 : BEEP I%, 1 : NEXT I% 
290 C$ = INKEY$ : IF C$ = "" THEN 290
300 CL$ = "             "
2000 REM --- ( Suite du jeu Samarcande ) ---
2010 CLS
2020 MH$(1) = ME$(1) : MH$(2) = MR$(1)
2025 MB$(1) = ME$(2) : MB$(2) = MR$(2)
2030 MH$(3) = GA$(1) : MB$(3) = GA$(2)
2035 MH$(4) = MG$(1) : MB$(4) = MG$(2)
2040 AT$(1) = "AMICAL" : AT$(2) = "NEUTRE" : AT$(3) = "HOSTILE" : AT$(4) = "AGRESSIF"
2050 D$(1) = "SUD" : D$(2) = "EST" : D$(3) = "NORD" : D$(4) = "OUEST"
2055 DI$(1) = "S" : DI$(2) = "E" : DI$(3) = "N" : DI$(4) = "O"
2060 REM --( Creation personnage )---
2070 CLS : PRINT "VOTRE PERSONNAGE :" : FO% = 0 : AG% = 0
2075 CH% = 0 : PT% = 25
2076 LOCATE 6,1 : PRINT "FORCE"
2077 LOCATE 4,2 : PRINT "AGILITE"
2078 LOCATE 4,3 : PRINT "points restants";
2080 LOCATE 12,1: IF CH% = 0 THEN PRINT ">"; ELSE PRINT " ";
2082 PRINT FO%
2085 LOCATE 12,2 : IF CH% = 1 THEN PRINT ">"; ELSE PRINT " ";
2087 PRINT AG%
2088 LOCATE 0,3 : PRINT PT%;
2090 K = STICK(0)
2091 IF K=1 OR K=5 THEN CH% = CH% + 1 : IF CH% > 1 THEN CH% = 0
2092 IF K=3 AND PT%>0 AND CH%=0 AND FO% < 18 THEN FO% = FO% + 1 : PT% = PT% - 1
2093 IF K=3 AND PT%>0 AND CH%=1 AND AG% < 18 THEN AG% = AG% + 1 : PT% = PT% - 1
2094 IF K=7 AND CH%=0 AND FO%>0 THEN FO% = FO% - 1 : PT% = PT% + 1
2095 IF K=7 AND CH%=1 AND AG%>0 THEN AG% = AG% - 1 : PT% = PT% + 1
2096 IF PT% > 0 THEN GOTO 2080
2130 PV = INT(RND(0)*10)+10
2140 PO = INT(RND(0)*25)+10
2150 CLS : PRINT "VOTRE PERSONNAGE :"
2160 PRINT "FOR.:";FO% ; " AGIL.:";AG%;
2180 PRINT "PTS DE VIE:";PV
2190 PRINT " PIECES D'OR:";PO;
2195 C$ = INKEY$ : IF C$ = "" THEN 2195
2200 CLS : PRINT MR$(1); " Une arme, sir ?"
2205 PRINT MR$(2); "  1. DAGUE.....10"
2210 PRINT "    2. EPEE......20"
2220 PRINT "    3. HACHE.....30";
2230 C$ = INKEY$ : IF C$ = "" THEN 2230
2235 IF C$ < "1" OR C$ > "3" THEN GOTO 2230
2240 A = VAL(C$)
2250 DA = A * 2 : PO = PO - (A*10)
2260 IF PO < 0 THEN PO = PO + (A*10) : GOTO 2230
2270 CLS
2280 PRINT "Les gardes  verifient" : PRINT "   vos papiers...   "
2290 REM *----- TERRAIN -----*
2300 DIM A(12,24), V(10), Z(5)
2310 DATA 1,1,1,1,1,1,1,1,1,1
2320 DATA 1,0,0,0,1,1,0,0,0,1
2330 DATA 1,0,1,0,0,1,0,1,1,1
2340 DATA 1,0,1,1,0,1,0,1,1,1
2350 DATA 1,0,0,1,0,1,0,0,0,1
2360 DATA 1,1,0,0,0,0,0,1,0,1
2370 DATA 1,0,0,1,0,1,0,0,0,1
2380 DATA 1,0,1,1,0,0,0,1,1,1
2390 DATA 1,0,1,0,0,1,0,0,0,1
2400 DATA 1,0,0,0,1,1,0,1,0,1
2410 DATA 1,1,1,0,1,1,0,1,1,1
2420 DATA 1,0,0,0,0,0,0,0,0,1
2430 DATA 1,1,0,1,1,1,1,1,0,1
2440 DATA 1,0,0,1,0,0,0,0,0,1
2450 DATA 1,1,1,1,0,1,1,0,1,1
2460 DATA 1,0,0,0,0,1,0,0,0,1
2470 DATA 1,1,0,1,0,0,0,1,1,1
2480 DATA 1,0,0,0,0,1,0,0,0,1
2490 DATA 1,1,1,0,1,0,1,0,1,1
2500 DATA 1,1,0,0,0,0,0,0,0,1
2510 DATA 1,0,0,1,0,1,0,1,0,1
2520 DATA 1,1,1,1,1,1,1,1,1,1
2530 RESTORE 2310
2540 FOR Y% = 2 TO 23
2550 FOR X% = 2 TO 11
2560 READ A(X%,Y%)
2570 NEXT X% : PRINT "."; : NEXT Y%
2580 REM --- Localisation de Nordal ---
2590 K = RND(0) : RM = 1
2600 XL = INT(RND(1) * 7) + 3
2610 YL = INT(RND(1) * 19) + 3
2620 IF A(XL,YL) = 1 THEN  2590
2630 IF A(XL,YL-1) = 0 THEN 2590
2640 XJ = 8 : YJ = 8 : R = 2 : AC = 7 : GOTO 2700
2650 REM ==== CHOIX DU JOUEUR ====
2660 LOCATE 6,0 : PRINT "DIR ";DI$(R);: PRINT USING "##/##";XJ;YJ;
2670 LOCATE 6,1 : PRINT USING "PV ## OR ###";PV;PO;
2680 AC = STICK(0)
2690 IF AC = 2*INT(AC/2) THEN 2680 : REM PAIR donc diagonale
2700 CLS
2710 LINE (0,0)-(31,0) : LINE -(31,31) : LINE -(0,31) : LINE -(0,0)
2720 IF AC = 1 THEN 3220
2730 IF AC = 7 THEN R = R - 1 : GOTO 2770
2740 IF AC = 3 THEN R = R + 1 : GOTO 2770
2750 IF AC = 5 THEN R = R + 2 : GOTO 2770
2760 GOTO 2650
2770 IF R > 4 THEN R = R - 4
2780 IF R < 1 THEN R = R + 4
2790 IF R = 1 THEN A=-2:B=0:C=-1:D=1:W1=1:W2=1
2800 IF R = 2 THEN A=-1:B=1:C=2:D=0:W1=-1:W2=1
2810 IF R = 3 THEN A=2:B=0:C=1:D=-1:W1=-1:W2=-1
2820 IF R = 4 THEN A=1:B=-1:C=-2:D=0:W1=1:W2=-1
2830 IF R=2 OR R=4 THEN 2920
2840 REM --- REGARD NORD/SUD -----*
2850 N% = 0 : FOR YT = YJ+A TO YJ+B STEP W1
2860 FOR XT = XJ+C TO XJ+D STEP W2
2870 N% = N% + 1
2880 V(N%) = A(XT,YT)
2890 NEXT XT : NEXT YT
2900 GOTO 2990
2910 REM --- REGARD EST/OUEST ----*
2920 N% = 0 : FOR XT = XJ+C TO XJ+D STEP W1
2930 FOR YT = YJ+A TO YJ+B STEP W2
2940 N% = N% + 1
2950 V(N%) = A(XT,YT)
2960 NEXT YT : NEXT XT
2970 REM --- AFFICHAGE DU REGARD ----*
2980 REM ---- ETAPE 1 ----
2990 IF V(7)=1 THEN LINE (1,1)-(5,5) : LINE -(5,26) : LINE -(1,30)
3000 IF V(7)=0 AND V(4) = 1 THEN LINE (1,5)-(5,5) : LINE -(5,26) : LINE -(1,26)
3010 IF V(9)=1 THEN LINE (30,1) -(26,5) : LINE -(26,26): LINE -(30,30)
3020 IF V(9)=0 AND V(6)=1 THEN LINE (30,5)-(26,5) : LINE -(26,26) : LINE -(30,26)
3030 IF V(5)=0 THEN 3140
3040 LINE (5,5)-(26,5) : LINE -(26,26) : LINE -(5,26) : LINE -(5,5)
3045 LINE (12,26)-(19,26) : LINE -(19,12) : LINE -(12,12) : LINE -(12,26)
3050 LOCATE 6,3: PRINT "ENTREE (O/N)?";
3060 R$ = INKEY$ : IF R$ = "" THEN 3060
3065 IF R$ <> "N" AND R$ <> "O" THEN 3050
3070 IF R$<> "O" THEN LOCATE 6,3 : PRINT CL$; : GOTO 2680
3090 TA = INT(RND(0)+0.8)
3100 IF TA >= 1 THEN GOTO 3110
3101 LOCATE 6,3 : PRINT "C'EST FERME !";
3102 FOR I=1 TO 100 : NEXT I
3103 R$ = INKEY$ : IF R$ = "" THEN 3103
3105 LOCATE 6,3 : PRINT CL$; : GOTO 2680
3110 IF XJ=XL AND YJ=YL THEN GOTO 5000 : REM ECRAN DE VICTOIRE
3120 GOTO 3570
3130 REM ---- ETAPE 2 ----
3140 IF V(4)=1 THEN LINE (9,9)-(5,5):LINE -(5,26):LINE -(9,22):LINE -(9,9)
3150 IF V(4)=0 AND V(1)=1 THEN LINE (9,9)-(5,9):LINE -(5,22):LINE -(9,22):LINE -(9,9)
3160 IF V(6)=1 THEN LINE (22,9)-(26,5):LINE -(26,26):LINE -(22,22):LINE -(22,9)
3170 IF V(6)=0 AND V(3)=1 THEN LINE (26,9)-(22,9):LINE -(22,22):LINE -(26,22):LINE -(26,9)
3180 IF V(2)=1 THEN LINE (22,9)-(9,9):LINE -(9,22):LINE -(22,22):LINE -(22,9) : GOTO 2650
3190 IF V(1)=1 THEN LINE (12,12)-(9,9):LINE -(9,22):LINE -(12,19):LINE -(12,12)
3200 IF V(3)=1 THEN LINE (22,9)-(19,12):LINE -(19,19):LINE -(22,22):LINE -(22,9)
3210 GOTO 2650
3220 REM --- AVANCE ---
3230 IF V(5)=1 THEN LOCATE 6,3 : PRINT "IMPOSSIBLE ! "; : GOTO 3050
3240 IF R=1 THEN YJ = YJ - 1
3250 IF R=2 THEN XJ = XJ + 1
3260 IF R=3 THEN YJ = YJ + 1
3270 IF R=4 THEN XJ = XJ - 1
3280 GOTO 2830
3290 REM --- COMBAT PAR SORT ---
3300 CLS
3310 XZ = INT(RND(1)*280)+10
3320 YZ = INT(RND(1)*280)+10
3330 PSET (INT(XZ/10), INT(YZ/10))
3340 LINE (15,15)-(16,16) : LINE (16,15)-(15,16)
3360 CR=0.01745
3370 LOCATE 6,0 : INPUT "INVOC. :";M$
3380 FOR I%=1 TO LEN(M$)
3390 Z(I%) = ASC(MID$(M$,I%,1)) - 65 : NEXT I%
3400 Q = Z(1) * 90 : D = Z(2) * 3 : EN = Z(3) * 5 
3410 AN = Q + D : V = Z(4) * 2 
3430 XI = INT(SIN(AN*CR)*EN)
3440 YI = INT(COS(AN*CR)*EN)
3445 XC = INT(XI/10) : YC = INT(YI/10)
3450 LINE (15,15)- STEP (XC,YC)
3460 FOR I=1 TO 100 STEP 7
3470 XX = SIN(I)*V : YY=COS(I)*V
3480 LINE (15+XC,15+YC) - STEP (INT(XX/10),INT(YY/10))
3490 NEXT I
3500 DX = 150 + XI - XZ : DY = 150 + YI - YZ
3510 DS = DX*DX+DY*DY 
3520 IF DS > V*V THEN 4020
3540 VP = VP - (DA*2) : GOTO 4010
3550 A$ = INKEY$ : IF A$="" THEN 3550
3560 GOTO 4010
3570 REM --- RENCONTRES ---
3580 ZG = 0
3590 F = INT(RND(0)*4)+1
3600 G = INT(RND(1)*4)+1
3610 LOCATE 2,2 : PRINT MH$(F);:LOCATE 2,3 : PRINT MB$(F);
3620 LOCATE 6,2 : PRINT AT$(G);
3630 LOCATE 6,3 : PRINT "ACT. ?(Q,A,R)";
3640 R$ = INKEY$ : IF R$ = "" THEN 3640
3645 IF R$ = "Q" THEN LOCATE 6,3 : PRINT "  AU REVOIR ! ";:GOTO 2700
3650 IF R$ = "A" THEN 3810
3660 IF R$ = "R" THEN 3680
3670 GOTO 3630
3680 CLS : PRINT "- OU EST NORDAL ?"
3690 IF ZG > 0 THEN PRINT "IL SE JETTE SUR VOUS " : GOTO 3810
3700 DX = XJ - XL : DY = YJ - YL
3710 DS = INT(SQR(DX*DX+DY*DY))
3720 D1 = 0 : D2 = 0
3730 IF DX > 0 AND DY > 0 THEN D1 = 3 : D2 = 4
3740 IF DX < 0 AND DY > 0 THEN D1 = 3 : D2 = 2
3750 IF DX > 0 AND DY < 0 THEN D1 = 1 : D2 = 4
3760 IF DX < 0 AND DY < 0 THEN D1 = 1 : D2 = 2
3770 IF D1 = 0 AND D2 = 0 AND G < 3 THEN PRINT"NOZO HI VAR ";DS : GOTO 3800
3780 IF G < 3 THEN PRINT "-HIZO VAR ";D$(D1);"-";D$(D2)
3790 IF G > 2 THEN PRINT "-ZAKMUL AK MULDUR !"; : ZG = ZG + 1
3800 GOTO 3610
3810 REM --- PERSO ---
3830 GA = INT(RND(0)*F)+12
3840 OF = INT(RND(1)*G)+12
3850 VP = INT(RND(1)*4)+1
3860 OP = INT(RND(1)*30)+5
3870 AD = INT(RND(1)*4)+1
3880 REM ----
3890 REM --- COMBAT ---
3900 CLS
3910 PRINT "(A)tt,(F)uir,(S)ort";
3920 A$=INKEY$ : IF A$="" THEN 3920
3930 IF A$="A" THEN 3970
3940 IF A$="F" THEN 4110
3950 IF A$="S" THEN 3300
3960 GOTO 3900
3970 REM --- Attaque ---
3980 PA = INT(RND(1)*9)+10
3990 IF PA<OF THEN PRINT "RATE !" : FOR I=1 TO 100 : NEXT I : GOTO 4030
4000 PRINT "TOUCHE !" : VP = VP - DA : FOR I=1 TO 100 : NEXT I
4010 IF VP > 0 THEN GOTO 4020
4012 CLS : PRINT "TUE !" : PRINT "VOUS TROUVEZ ";OP;" PO.":PO=PO+OP:R=R+1
4014 R$ = INKEY$ : IF R$ = "" THEN 4014
4015 GOTO 2700
4020 REM ---RIPOSTE---
4030 AP=INT(RND(1)*9)+10
4040 IF AP<FO THEN PRINT "IL RATE !" : GOTO 3900
4050 PRINT "IL TOUCHE !" : PV = PV - AD
4060 IF PV <= 0 THEN PRINT "VOUS ETES MORT !" : END
4070 PRINT "VOS PVs : ";PV
4080 PRINT "SES PVs : ";VP
4090 A$ = INKEY$ : IF A$ = "" THEN 4090
4100 GOTO 3890
4110 REM --- Fuite ---
4120 PRINT "TENTATIVE DE FUITE..."
4130 IF AG>GA THEN PRINT "REUSSIE !" : GOTO 3620 
4140 PRINT "ECHEC !" : GOTO 4020
5000 REM --- ECRAN DE VICTOIRE ---
5010 CLS : PRINT MG$(1); " NORDAL !"
5020 PRINT MG$(2); "- Combien argent?"
5030 PRINT "  - Voici "; PO; " po."
5035 A$ = INKEY$ : IF A$ = "" THEN 5035
5040 PRINT "- Merci. Voici la   carte pour Arrakis !"
5050 PRINT "Suite dans Arrakis!";
5060 A$ = INKEY$ : IF A$ = "" THEN 5060
5070 END

 